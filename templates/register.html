<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
    <meta name="viewport" content="width=device-width" initial-scale="1">
  <title>Register | Cookie Tap</title>
  <link href="{{url_for('static', filename='style-reg.css')}}" rel="stylesheet" type="text/css" />
      <link rel="icon" href="{{url_for('static', filename='assets/pngegg.png')}}" type="image/png">
</head>

<body>
    <header class="top-bar">
        <section class="logo">
            <img class="logo" src="{{url_for('static', filename='assets/pngegg.png')}}" alt="logo" width="50px"
                height="40px">
            <h1 class="logo-title"><a href="https://cookie-1.risalahqz.repl.co">Cookie Tap</a></h1>
        </section>
<script>
  function bt_sound(){var audio = new Audio("{{url_for('static', filename='assets/button_tap.mp3')}}");
    audio.loop = false;
audio.play();}
</script>
        <section>
            <nav class="nav">
                <ul class="nav_links">
                    <li><button class="ld1" onclick="bt_sound()"><a href="https://cookie-1.risalahqz.repl.co/leaderboard" >Leaderboards</a></button></li>
                </ul>
               <nav class="nav">
        <ul class="nav_links">
          <li><button id="lamgu" class="ld1" onclick="lagu()">
                >sound</a></button>
          <script>
          var audios = new Audio("{{url_for('static', filename='assets/lobby_theme.mp3')}}");
            let mute=0
        function lagu(){
          console.log(mute);
          var audio = new Audio("{{url_for('static', filename='assets/button_tap.mp3')}}");
    audio.loop = false;
audio.play();
          mute++;
    if (mute%2!=0){audios.loop = true;
        audios.muted = false;
    audios.volume = 0.7;
          console.log("goyans");document.getElementById("lamgu").innerHTML =">sound";
audios.play();}else{audios.muted=true;document.getElementById("lamgu").innerHTML ="muted";}}
        
  </script>
          </li>
       
        </ul>
      </nav>
            </nav>
        </section>
    </header>

    <main>
        <section class="register">
            <div class="title">REGISTER</div>
            <div class="sub-title"><p id="demo">Can't wait to see your action!</p></div>
            <form class="register1" id="register1">
                <div class="uname">
                    <label for="uname-lbl">USERNAME</label>
                    <input class="uname-input" type="username" placeholder="Enter your username" value="">
                </div>
                <div class="pwd">
                    <label for="pwd-lbl">PASSWORD</label>
                    <input class="pwd-input" type="password" placeholder="Enter your password" value="">
                  <button class="submit-bt" id="sumbit" onclick="submits()" >Register Now</button>
                  </form>
                    
                </div>
            
        

        <!-- <form id="register1">
            username: <br>
            password: <input type="password" value=""><br>
        </form>
        <p id="demo"></p>
        <button id="submit" onclick="submits()">Register Now!</button>
        <button id="login" onclick="location.replace('https://serverCookie.colabbren.repl.co/login')">LOGIN</button> -->

        <script>
          //function stopRefresh(event) { event.preventDefault(); } 
            function submits() {
              var audio = new Audio("{{url_for('static', filename='assets/button_tap.mp3')}}");
    audio.loop = false;
audio.play();
              event.preventDefault();
              
                var x = document.getElementById("register1");
            //  x.addEventListener('submit', stopRefresh);
                let username = x.elements[0].value;
                let password = x.elements[1].value;
                if( username==="" && password===""){document.getElementById("demo").innerHTML = "form cant be a blank identity"; return 0;}
                if (username.length>15 || password.length>15){document.getElementById("demo").innerHTML = "character length to >15"; return 0;}
                let payload = JSON.stringify({ request: [username, password] });
                console.log((payload), typeof (payload));
                const options = {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: payload
                };

                fetch('https://cookie-1.risalahqz.repl.co/registers', options)
                    .then(response => response.json())
                    .then(response => {
                        if (response.respond === "existed") {
                            document.getElementById("demo").innerHTML = "The account already existed.";
                        } else {
                            document.getElementById("demo").innerHTML = "Register succeed, login to play!";alert('Please login to play, redirecting to home page.');location.href = "https://cookie-1.risalahqz.repl.co";
                        }
                    })
                    .catch(err => console.error(err));
               }
        </script>
    </section>
    </main>
</body>

</html>
